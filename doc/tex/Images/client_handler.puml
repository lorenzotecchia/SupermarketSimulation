@startuml
start
:Inizializza Gestore Clienti;
:Leggi Comando dal Cliente;

repeat
  if (Comando è "ENTRY_REQUEST") then (sì)
    :Analizza Richiesta di Ingresso;
    :Blocca Mutex Supermercato;
    if (Possiamo Ammettere Cliente?) then (sì)
      :Ammetti Cliente;
      :Aggiorna Lista d'Attesa;
      :Invia "ENTRY_ACCEPTED" al Cliente;
    else (no)
      :Invia "ENTRY_DENIED" al Cliente;
    endif
    :Sblocca Mutex Supermercato;
  endif
  if (Comando è "PAYMENT_REQUEST") then (sì)
    :Processa Pagamento;
    :Stampa Conferma Pagamento;
  endif
  if (Comando è "NO_ITEMS_EXIT_REQUEST") then (sì)
    :Stampa Conferma Uscita;
  endif
  :Leggi Prossimo Comando;
repeat while (Comando non è "QUIT")

:Chiudi Connessione Cliente;
stop
@enduml
